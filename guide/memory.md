# 内存目标跟踪伸缩策略
内存目标跟踪伸缩策略通过监控内存使用率，自动调整实例数量。

## 配置查看与修改

您可以通过弹性伸缩（UAS）控制台，伸缩组的详情，规则信息部分，查看内存目标检查**是否开启**。

通过点击更改规则修改相关设置，包括开启与关闭，以及目标值。
![更改规则](https://www-s.ucloud.cn/2025/12/3220015a1a7ba87378653990308b8235_1766645339105.png)


## 核心计算逻辑
内存目标跟踪伸缩策略根据伸缩组内云主机的内存使用率，自动调整实例数量，维持设定的目标内存使用率。

### 基本计算公式
系统定期采集伸缩组内所有云主机的内存指标，并通过以下公式计算期望的实例数，通过跟踪内存目标值来伸缩来扩缩容：

```
期望实例数 = ⌈所有实例内存使用率之和 / 目标内存使用率⌉
```

**计算示例：**

- 当前 3 台云主机，各自内存使用率：60%、70%、80%
- 目标内存使用率：50%
- 计算：⌈(60 + 70 + 80) / 50⌉ = ⌈210 / 50⌉ = 5
- 系统将扩容至 5 台云主机


## 伸缩行为

### 扩容触发条件
- 当前实例数在最小/最大范围内
- 所有健康实例的内存总和超过 (当前实例数 × 扩容目标值) 5%
- 不在冷却期内

### 缩容触发条件：
- 当前实例数在最小/最大范围内
- 所有健康实例的内存总和低于 (期望实例数 × 缩容目标值) 5%
- 不在冷却期内

### 边界调整场景
当实例数超出配置的最小/最大限制时，系统会立即调整，不受内存使用率影响：

- **低于最小值**：立即扩容至最小实例数
- **高于最大值**：立即缩容至最大实例数

## 注意事项

- 内存指标强依赖安装监控agent，请确保主机模版中配置的镜像内安装了agent并设置开机自启动，否则可能导致指标采集异常，影响伸缩决策准确性。

- 内存目标检查规则与CPU目标检查规则独立存在于伸缩组规则中，可分别启用或禁用，互不影响。
